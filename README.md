# S.A.G.A Tactical Map OSINT Viewer
*Sea & Air Global Awareness*

Saga is a distributed Command & Control (C2) demonstrator. The intention is to create a map that allows a commander to view open source intelligence into a unified picture. The application aggregates real-time tracking data from disparate sources (air and sea), normalizes it via a cloud middleware and renders it on a Windows desktop client showing a geospatial map.

# Architecture
The codebase is organized as a monorepo and follows a modern architecture designed to decouple the frontend from external API volatility. I.e. if there are changes on the API layer or we wish to add a different sources this only needs to be changed in one place.

There are three distinct layers: 
- Saga.Client (WPF/.NET): Tactical display using Mapsui v5 for hardware-accelerated rendering and smooth animations
- Saga.Server (Azure Functions): Serverless code that fetches raw data from external providers and transforms into internal data contract
- Saga.Shared (DTO): Common library ensuring compile-time contract between client and server

# Technology Stack
- IDE: Visual Studio 2026
- Framework: .NET 10 with C#
- Client: WPF with MVVM architecture
- Map Engine: Mapsui 5.0 (OpenStreetMap)
- Backend: Azure Functions (Isolated HTTP trigger)

# Data Providers
The tactical picture is generated by aggregating data from the following Open Source Intelligence (OSINT) providers:

- **OpenSky Network (Air):** Provides real-time state vectors for aircraft globally. The application polls the `states/all` endpoint filtered to Northern Europe every **5 seconds**.
- **BarentsWatch (Sea):** Provides maritime AIS data for Norwegian waters and surrounding areas. The application polls the `latest/combined` AIS endpoint every **10 seconds**.

# Local Installation
1. Clone the repository.

2. Open `Saga.slnx` in Visual Studio 2026.

3. Right-click the Solution and select "Set Startup Projects".

4. Choose Multiple Startup Projects and set both Saga.Client and Saga.Server to Start.

5. Press F5 to launch the secure gateway and the client simultaneously.

# API Authentication Setup
To fetch live data, you must configure credentials for the external data providers. Add the following keys to your `src/Saga.Server/local.settings.json` file (create it if missing):

```json
{
  "IsEncrypted": false,
  "Values": {
    "AzureWebJobsStorage": "UseDevelopmentStorage=true",
    "FUNCTIONS_WORKER_RUNTIME": "dotnet-isolated",
    "OpenSkyClientId": "YOUR_OPENSKY_CLIENT_ID",
    "OpenSkyClientSecret": "YOUR_OPENSKY_CLIENT_SECRET",
    "BarentsWatchClientId": "YOUR_BARENTSWATCH_CLIENT_ID",
    "BarentsWatchClientSecret": "YOUR_BARENTSWATCH_CLIENT_SECRET"
  }
}
```

### 1. OpenSky Network (Air Data)
1. Register at [OpenSky Network](https://opensky-network.org).
2. Create an API Client in your user profile.
3. Verify your credentials with this PowerShell command:
   ```powershell
   $body = @{
       grant_type    = "client_credentials"
       client_id     = "YOUR_CLIENT_ID"
       client_secret = "YOUR_CLIENT_SECRET"
   }
   Invoke-RestMethod -Uri "https://auth.opensky-network.org/auth/realms/opensky-network/protocol/openid-connect/token" -Method Post -Body $body
   ```

### 2. BarentsWatch (Sea Data)
1. Register at [BarentsWatch](https://www.barentswatch.no/).
2. Create a Client and ensure you request the `ais` scope.
3. Verify your credentials with this PowerShell command:
   ```powershell
   $body = @{
       grant_type    = "client_credentials"
       scope         = "ais"
       client_id     = "YOUR_CLIENT_ID"
       client_secret = "YOUR_CLIENT_SECRET"
   }
   Invoke-RestMethod -Uri "https://id.barentswatch.no/connect/token" -Method Post -Body $body
   ```